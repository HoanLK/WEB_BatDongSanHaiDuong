(function(n){"use strict";function t(n,t,i,r,u,f,e,o,s,h,c){function l(){n.id=u.id;e.CheckNull(n.id)?(n.page.title="Sửa Danh mục Bài viết",v(n.id)):(n.page.title="Thêm Danh mục bài viết",a());y()}function a(){n.categoryPost={Published:!0}}function v(t){c.GetById(t).then(function(t){n.categoryPost=angular.copy(t.data);n.tempCategoryPost=angular.copy(n.categoryPost)},function(){toastr.error("Không tìm thấy Danh mục");c.RedirectList()})}function y(){c.GetListViewModel("select").then(function(t){n.categoryPosts=angular.copy(e.GenMultiLevel(t.data))},function(){toastr.error("Không lấy được Danh sách danh mục")})}function p(){var t=0;return angular.forEach(n.valid,function(n,i){if(!n){switch(i){case"Title":toastr.error("Nhập Tiêu đề");break;case"Alias":toastr.error("Nhập Alias")}t++}}),t===0?!0:!1}function w(){return!angular.equals(n.categoryPost,n.tempCategoryPost)}n.page={};n.categoryPosts=[];n.tempCategoryPosts=[];n.categoryPost={};n.tempCategoryPost={};n.selectedCategoryPosts=[];n.valid={Title:!1,Alias:!1};n.statuses=[{text:"Xuất bản",value:!0},{text:"Không xuất bản",value:!1}];l();n.Save=function(t){p()&&(e.CheckNull(n.id)?w()?c.Edit(n.categoryPost.Id,n.categoryPost).then(function(){n.tempCategoryPost=angular.copy(n.categoryPost);toastr.success("Lưu thành công");c.RedirectAfterEdit(t)},function(){toastr.error("Lưu thất bại")}):c.RedirectAfterEdit(t):c.Create(n.categoryPost).then(function(n){toastr.success("Thêm thành công");c.RedirectAfterCreate(t,n.data.Id)},function(){toastr.error("Thêm thất bại")}))};n.Cancel=function(){c.RedirectCancel()};n.tab=1;n.SetTab=function(t){n.tab=t};n.IsSet=function(t){return n.tab===t};n.GenAlias=function(){n.valid.Title?n.categoryPost.Alias=h.GenAlias(n.categoryPost.Title):toastr.error("Vui lòng nhập Tiêu đề")};n.ChooseImage=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.categoryPost.Image=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.CheckNullTitle=function(){return e.CheckNull(n.categoryPost.Title)?(n.valid.Title=!0,!0):(n.valid.Title=!1,!1)};n.CheckNullAlias=function(){return e.CheckNull(n.categoryPost.Alias)?(n.valid.Alias=!0,!0):(n.valid.Alias=!1,!1)}}n.controller("editCategoryPostController",t);t.$inject=["$scope","$http","$window","$cookies","$routeParams","ArrayService","CommonService","DateTimeService","DevExtremeService","StringService","CategoryPostService"]})(angular.module("backend"));