(function(n){"use strict";function t(n,t,i,r,u,f,e,o){function c(){s()}function s(){o.GetListViewModel("table").then(function(t){n.categoryPosts=angular.copy(u.GenMultiLevel(t.data))},function(){toastr.error("Không lấy được Danh sách danh mục")})}n.page={title:"Danh sách Danh mục Bài viết"};n.categoryPosts=[];n.categoryPost={};n.selectedCategoryPosts=[];n.deleteCategoryPost={status:!1,title:"Bạn có chắc chắn muốn xóa?",popup:{width:"auto",height:"auto",contentTemplate:"templateDeleteCategoryPost",showTitle:!1,bindingOptions:{visible:"deleteCategoryPost.status"}}};n.gridCategoryPosts=angular.copy(f.DefaultGrid);n.gridCategoryPosts.bindingOptions={dataSource:"categoryPosts"};n.gridCategoryPosts.columns=[{caption:"ID",dataField:"Id",minWidth:60},{caption:"Trạng thái",dataField:"Published",cellTemplate:"publishedCellTemplate",trueText:"Xuất bản",falseText:"Chưa xuất bản",minWidth:90},{caption:"Tiêu đề",dataField:"Title",dataType:"string",minWidth:150},{caption:"Alias",dataField:"Alias",dataType:"string",visible:!1,minWidth:150},{alignment:"center",caption:"Số bài viết",dataField:"PostNumber",cellTemplate:"postnumberCellTemplate",minWidth:90},{caption:"Alias",dataField:"Alias",dataType:"string",visible:!1},{alignment:"left",caption:"Ghi chú",dataField:"Note",dataType:"string",visible:!1,minWidth:100}];n.gridCategoryPosts.export={allowExportSelectedData:!0,enabled:!0,excelFilterEnabled:!0,excelWrapTextEnabled:!0,fileName:"Danh sách Danh mục Bài viết",texts:{exportAll:"Xuất toàn bộ Dữ liệu",exportSelectedRows:"Xuất dữ liệu đang chọn",exportTo:"Trích xuất"}};n.gridCategoryPosts.headerFilter.visible=!1;n.gridCategoryPosts.summary={texts:{count:"{0}",sum:"{0}"},groupItems:[{column:"Id",summaryType:"count"}],totalItems:[{column:"Id",summaryType:"count"}]};n.gridCategoryPosts.remoteOperations={paging:!1,filtering:!1,sorting:!1,grouping:!1,summary:!1,groupPaging:!1};n.gridCategoryPosts.onToolbarPreparing=function(t){var i=t.component;t.toolbarOptions.items.unshift({location:"before",widget:"dxButton",options:{hint:"Thêm",icon:"add",type:"success",onClick:function(){n.Create()}}},{location:"before",widget:"dxButton",options:{hint:"Sửa",icon:"edit",type:"default",onClick:function(){n.Edit()}}},{location:"before",widget:"dxButton",options:{hint:"Xóa",icon:"trash",type:"danger",onClick:function(){n.Delete()}}})};n.gridCategoryPosts.onRowClick=function(t){var i=t.component,r;i.clickCount=i.clickCount?i.clickCount+1:1;i.clickCount===1?(i.lastClickTime=new Date,setTimeout(function(){i.lastClickTime=0;i.clickCount=0},350)):i.clickCount===2&&(r=new Date,r-i.lastClickTime<300&&(n.categoryPost=angular.copy(t.data),n.Edit()),i.clickCount=0,i.lastClickTime=0)};n.gridCategoryPosts.onSelectionChanged=function(t){n.selectedCategoryPosts=angular.copy(t.selectedRowsData)};var h=angular.copy(f.DefaultContextMenuGrid);n.contextMenuCategoryPost={dataSource:h,width:100,target:"#categoryPost",itemTemplate:angular.copy(f.TemplateContextMenuGrid),onItemClick:function(t){if(!t.itemData.items)switch(t.itemData.value){case"add":n.Create();break;case"edit":n.Edit();break;case"delete":n.Delete()}}};c();n.Create=function(){o.RedirectCreate()};n.Edit=function(){n.selectedCategoryPosts.length===0?toastr.error("Chọn 1 dòng để sửa"):(n.categoryPost=angular.copy(n.selectedCategoryPosts[0]),o.RedirectEdit(n.categoryPost.Id))};n.Delete=function(){n.selectedCategoryPosts.length===0?toastr.error("Chọn dòng để xóa"):n.deleteCategoryPost.status=!0};n.ConfirmDelete=function(){var t=r.GetArrayIds(n.selectedCategoryPosts);o.DeleteList(t).then(function(){s();n.deleteCategoryPost.status=!1;toastr.success("Xóa thành công")},function(){toastr.error("Không thể xóa")})};n.CancelDelete=function(){n.deleteCategoryPost.status=!1}}n.controller("listCategoryPostController",t);t.$inject=["$scope","$http","$window","ArrayService","CommonService","DevExtremeService","StringService","CategoryPostService"]})(angular.module("backend"));